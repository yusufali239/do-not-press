<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hadis Mavzulari - To'liq Vazifa Tizimi</title>

  <!-- jsPDF (PDF yuklab olish uchun) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container{ max-width: 1400px; margin: 0 auto; }

    .header{
      background: white;
      padding: 50px;
      border-radius: 25px;
      text-align: center;
      box-shadow: 0 15px 50px rgba(0,0,0,0.3);
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }

    .header::before{
      content:'‚ò™';
      position:absolute;
      font-size:200px;
      opacity:0.05;
      top:-30px;
      right:-30px;
    }

    .header h1{ color:#667eea; font-size: 3em; margin-bottom: 15px; position: relative; }
    .header p{ color:#666; font-size: 1.2em; position: relative; }

    .topics-container{
      background:white;
      padding: 50px;
      border-radius: 25px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }

    .topics-header{
      display:flex;
      justify-content: space-between;
      align-items:center;
      margin-bottom: 40px;
      padding-bottom: 25px;
      border-bottom: 4px solid #667eea;
      gap: 20px;
    }

    .topics-header h2{ color:#667eea; font-size: 2.5em; }

    .select-all-btn{
      padding: 15px 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:white;
      border:none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 700;
      cursor:pointer;
      transition: all .3s ease;
      white-space: nowrap;
    }

    .select-all-btn:hover{
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(102,126,234,0.5);
    }

    .info-box{
      background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
      padding: 25px;
      border-radius: 20px;
      margin-bottom: 30px;
      border-left: 6px solid #17a2b8;
      box-shadow: 0 5px 20px rgba(23,162,184,0.2);
    }

    .info-box h4{ color:#0c5460; margin-bottom: 15px; font-size: 1.3em; }
    .info-box p{ color:#0c5460; line-height: 1.8; font-size: 1.05em; }

    .selected-count{
      background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
      padding: 25px;
      border-radius: 20px;
      text-align: center;
      margin-bottom: 30px;
      border-left: 6px solid #ffc107;
      box-shadow: 0 5px 20px rgba(255,193,7,0.3);
    }

    .selected-count h3{ color:#856404; font-size: 1.5em; }

    .topic-card{
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 0;
      margin-bottom: 20px;
      border-radius: 20px;
      border: 4px solid transparent;
      transition: all .4s ease;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .topic-card:hover{
      border-color: #667eea;
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(102,126,234,0.3);
    }

    .topic-card.selected{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: #764ba2;
    }

    .topic-header{
      padding: 25px;
      cursor: pointer;
      display:flex;
      align-items:center;
      gap: 20px;
    }

    .checkbox{
      width: 35px;
      height: 35px;
      border: 3px solid #667eea;
      border-radius: 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 22px;
      transition: all .3s ease;
      flex-shrink: 0;
    }

    .topic-card.selected .checkbox{
      background:white;
      color:#667eea;
      border-color: white;
    }

    .topic-title-section{ flex: 1; }
    .topic-number{ font-size: .9em; font-weight: 600; opacity:.7; margin-bottom: 5px; }
    .topic-title{ font-size: 1.4em; font-weight: 700; margin-bottom: 8px; }
    .topic-desc{ font-size: 1em; opacity:.85; line-height: 1.5; }

    .expand-btn{
      padding: 8px 20px;
      background: rgba(102,126,234,0.1);
      border: 2px solid #667eea;
      color:#667eea;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor:pointer;
      transition: all .3s ease;
    }

    .topic-card.selected .expand-btn{
      background: rgba(255,255,255,0.2);
      border-color: white;
      color: white;
    }

    .expand-btn:hover{ background:#667eea; color:white; }
    .topic-card.selected .expand-btn:hover{ background:white; color:#667eea; }

    .topic-content{ max-height: 0; overflow: hidden; transition: max-height .5s ease; }
    .topic-content.expanded{ max-height: 5000px; }

    .topic-details{
      padding: 30px;
      background: rgba(255,255,255,0.95);
      color: #333;
      line-height: 2;
      border-top: 2px solid rgba(102,126,234,0.2);
    }

    .topic-card.selected .topic-details{
      background: rgba(255,255,255,0.15);
      color: white;
    }

    .topic-details h3{
      color:#667eea;
      margin: 25px 0 15px 0;
      font-size: 1.3em;
      padding-left: 15px;
      border-left: 5px solid #667eea;
    }

    .topic-card.selected .topic-details h3{
      color:white;
      border-left-color: white;
    }

    .topic-details p{ margin-bottom: 15px; text-align: justify; }
    .topic-details ul{ margin-left: 30px; margin-bottom: 15px; }
    .topic-details li{ margin-bottom: 10px; }

    .highlight-box{
      background: rgba(102,126,234,0.1);
      padding: 20px;
      border-radius: 12px;
      margin: 20px 0;
      border-left: 5px solid #667eea;
    }

    .topic-card.selected .highlight-box{
      background: rgba(255,255,255,0.2);
      border-left-color: white;
    }

    .conclusion-section{
      display:none;
      background:white;
      padding: 50px;
      border-radius: 25px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }

    .conclusion-section.active{
      display:block;
      animation: fadeIn .6s ease;
    }

    @keyframes fadeIn{
      from{ opacity:0; transform: translateY(30px); }
      to{ opacity:1; transform: translateY(0); }
    }

    .conclusion-section h2{
      color:#667eea;
      margin-bottom: 30px;
      font-size: 2.5em;
      border-bottom: 3px solid #667eea;
      padding-bottom: 15px;
    }

    .selected-topics-list{
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 30px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .selected-topics-list h3{
      color:#495057;
      margin-bottom: 20px;
      font-size: 1.5em;
    }

    .selected-topics-list ul{ list-style:none; padding:0; }
    .selected-topics-list li{
      padding: 15px 20px;
      background:white;
      margin-bottom: 12px;
      border-radius: 12px;
      border-left: 5px solid #667eea;
      font-size: 1.1em;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

    .conclusion-textarea{
      width:100%;
      min-height: 400px;
      padding: 25px;
      border: 3px solid #e9ecef;
      border-radius: 20px;
      font-size: 17px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      resize: vertical;
      transition: all .3s ease;
      line-height: 1.8;
    }

    .conclusion-textarea:focus{
      outline:none;
      border-color: #667eea;
      box-shadow: 0 0 0 5px rgba(102,126,234,0.15);
    }

    .action-buttons{
      display:flex;
      gap: 20px;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .btn{
      padding: 18px 50px;
      border:none;
      border-radius: 15px;
      font-size: 18px;
      font-weight: 700;
      cursor:pointer;
      transition: all .3s ease;
      display:flex;
      align-items:center;
      gap: 12px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }

    .btn-primary{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color:white;
      flex: 1;
    }

    .btn-primary:hover{
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(102,126,234,0.5);
    }

    .btn-secondary{
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color:white;
      flex: 1;
    }

    .btn-secondary:hover{
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(56,239,125,0.5);
    }

    .btn:disabled{ opacity:.5; cursor:not-allowed; transform:none !important; }

    .loading-overlay{
      display:none;
      position: fixed;
      top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.8);
      z-index: 9999;
      align-items:center;
      justify-content:center;
    }

    .loading-overlay.active{ display:flex; }

    .loading-content{
      background:white;
      padding: 50px;
      border-radius: 25px;
      text-align:center;
      box-shadow: 0 15px 50px rgba(0,0,0,0.5);
      max-width: 520px;
      width: calc(100% - 40px);
    }

    .spinner{
      width: 60px;
      height: 60px;
      border: 6px solid #f3f3f3;
      border-top: 6px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 25px;
    }

    @keyframes spin{
      0%{ transform: rotate(0deg); }
      100%{ transform: rotate(360deg); }
    }

    .loading-content h3{ color:#667eea; font-size: 1.5em; }
    .loading-content p{ margin-top: 10px; color:#666; }

    @media (max-width: 768px){
      .header h1{ font-size: 2em; }
      .topics-header{ flex-direction: column; align-items: flex-start; }
      .action-buttons{ flex-direction: column; }
      .btn{ width: 100%; justify-content: center; }
      .topic-header{ flex-direction: column; align-items: flex-start; }
      .expand-btn{ align-self: flex-start; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>üìö Hadis Mavzulari - To'liq Vazifa Tizimi</h1>
      <p>To'liq ma'lumotlar bilan o'zingizga tegishli mavzularni tanlang va xulosa yozing</p>
    </div>

    <div class="topics-container" id="topicsContainer">
      <div class="topics-header">
        <h2>Mavzular ro'yxati</h2>
        <button class="select-all-btn" onclick="toggleSelectAll()">
          <span id="selectAllText">‚úì Hammasini tanlash</span>
        </button>
      </div>

      <div class="info-box">
        <h4>üìù Yo'riqnoma:</h4>
        <p>
          1. Har bir mavzuni ochib to'liq ma'lumotlarni o'qing<br>
          2. O'zingizga tegishli mavzularni belgilang (checkbox bosish)<br>
          3. "Xulosa yozish" tugmasini bosing<br>
          4. Har bir mavzu bo'yicha o'z xulosangizni yozing<br>
          5. PDF formatda yuklab oling
        </p>
      </div>

      <div class="selected-count">
        <h3>Tanlangan mavzular: <span id="selectedCount">0</span> / <span id="totalCount">10</span></h3>
      </div>

      <div id="topicsList"></div>

      <div class="action-buttons">
        <button class="btn btn-primary" onclick="showConclusionSection()" id="conclusionBtn" disabled>
          ‚úçÔ∏è Xulosa yozish
        </button>
      </div>
    </div>

    <div class="conclusion-section" id="conclusionSection">
      <h2>üìù Xulosa yozish</h2>

      <div class="selected-topics-list">
        <h3>Tanlangan mavzular:</h3>
        <ul id="selectedTopicsList"></ul>
      </div>

      <div class="info-box">
        <h4>üí° Xulosa yozish bo'yicha maslahat:</h4>
        <p>
          ‚Ä¢ Har bir mavzu bo'yicha o'z fikr-mulohazalaringizni yozing<br>
          ‚Ä¢ Xulosangiz qisqacha, aniq va tushunarli bo'lishi kerak<br>
          ‚Ä¢ O'qigan ma'lumotlaringizdan qanday saboq olgansiz?<br>
          ‚Ä¢ Bu bilimlarni amalda qanday qo'llash mumkin?
        </p>
      </div>

      <textarea
        class="conclusion-textarea"
        id="conclusionText"
        placeholder="Bu yerga o'z xulosangizni yozing...

Masalan:

MUTAVOTIR XABAR BO'YICHA XULOSA:
Men bu mavzuni o'rganish orqali mutavotir xabarning ahamiyati va shartlarini chuqur tushunib yetdim...

MASHHUR XABAR BO'YICHA XULOSA:
Mashhur xabarning hanafiy va muhaddislar istilohidagi farqini o'rganish orqali..."
      ></textarea>

      <div class="action-buttons">
        <button class="btn btn-secondary" onclick="downloadPDF()">
          üì• PDF yuklab olish
        </button>
        <button class="btn btn-primary" onclick="backToTopics()">
          üîô Mavzularga qaytish
        </button>
      </div>
    </div>
  </div>

  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <h3>PDF tayyorlanmoqda...</h3>
      <p>Iltimos, kuting...</p>
    </div>
  </div>

  <script>
    const topicsData = [
      {
        id: 1,
        title: "Xabarlarning mutavotir, mashhur va ahodga bo'linishi",
        desc: "Hanafiylar va muhaddislarning taqsimoti, istilohlar farqi",
        content: `
          <h3>1 ‚Äî Hanafiylarning taqsimoti</h3>
          <p>Bizning hanafiy imomlarimiz Rasululloh Ô∑∫ ga bog'lanish (ittisol) jihatidan xabarlarni <strong>uch qismga</strong> bo'lishgan:</p>

          <div class="highlight-box">
            <strong>BIRINCHISI: MUTAVOTIR</strong><br>
            Surat va ma'no jihatidan mutlaqo shubhasiz, to'liq bog'lanishga ega bo'lgan xabar. Undagi bog'lanish to'liq bo'lib, unda hech qanday shubha yo'q.
          </div>

          <div class="highlight-box">
            <strong>IKKINCHISI: MASHHUR</strong><br>
            Surat jihatidan shubha bor (sahobalar davrida ahod bo'lgan), ammo ma'no jihatidan shubha yo'q (ikkinchi va uchinchi asrlarda mutavotir bo'lib, ummat tomonidan qabul qilingan).
          </div>

          <div class="highlight-box">
            <strong>UCHINCHISI: XABARUL-VOHID</strong><br>
            Surat va ma'no jihatidan shubha bor ‚Äî birinchi asrda ahod bo'lgan va mutavotir bo'lmagan.
          </div>

          <h3>2 ‚Äî Muhaddislarning taqsimoti</h3>
          <p>Muhaddislarning aksariyatiga ko'ra xabarlar <strong>ikki qismga</strong> bo'linadi: Mutavotir xabar va Xabarul-vohid. So'ng xabarul-vohid o'z navbatida uch qismga bo'linadi: mashhur, aziz, g'arib.</p>

          <h3>3 ‚Äî Ikki istilohni solishtirish</h3>
          <p>Muhaddislarning maqsadi ‚Äî isnod, shuning uchun ular roviylar soniga qarab bo'lishgan. Faqihlarning maqsadi esa ‚Äî matn va unga amal qilish, shuning uchun ular o'z mavzulariga foydali bo'lgan jihatdan bo'lishgan.</p>
        `
      },
      {
        id: 2,
        title: "Mutavotir xabar",
        desc: "Ta'rifi, shartlari, hukmi, aniq son masalasi va turlari",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <div class="highlight-box">
            <strong>LUG'ATDA:</strong> "Tavotur" ‚Äî narsalarning ketma-ket kelishi bo'lib, ularning orasida bo'shliqlar va vaqt oralig'i bo'lishidir.<br><br>
            <strong>ISTILOHDA:</strong> "O'z-o'zidan ilmni hosil qiladigan jamoa xabari" (Imom Ibn as-Sa'atiy)
          </div>

          <h3>2 ‚Äî Mutavotir xabarning shartlari (3 ta)</h3>
          <p><strong>1-SHART:</strong> Xabar beruvchilarning soni shunchalik ko'p bo'lishi kerakki, odatda aql ularning ataylab yolg'on ustida kelishib olishlarini imkonsiz deb bilsin.</p>
          <p><strong>2-SHART:</strong> Bu ko'plik isnodning barcha tabaqalarida mavjud bo'lishi kerak. Hanafiylar nazarida mutavotirlik uch asr ‚Äî sahobalar, tobe'inlar va tobe'ut-tobe'inlar bilan bog'liq.</p>
          <p><strong>3-SHART:</strong> Xabar his-tuyg'uga (sezgiga) asoslangan bo'lishi kerak, aqlga emas. Aqliy masalalarda mutavotir bo'lmaydi.</p>

          <h3>3 ‚Äî Hukmi</h3>
          <div class="highlight-box">
            <strong>MUHIM:</strong> Ko'pchilik ulamolar orasida mutavotir xabar <strong>zaruriy ilm beradi</strong>. Uni inkor qilgan kishi <strong>kofir bo'ladi</strong>.
          </div>

          <h3>4 ‚Äî Mutavotirda aniq son shartmi?</h3>
          <p>Hanafiylar nazarida mutavotir uchun aniq son shart emas. Balki mezon ‚Äî ilm va ishonch hosil bo'lishi. Qachon ilm hosil bo'lsa, o'sha xabar mutavotir hisoblanadi.</p>

          <h3>5 ‚Äî Mutavotirning turlari (4 ta)</h3>
          <ul>
            <li><strong>Isnod mutavotiri</strong> ‚Äî Masalan: "Kim menga atab yolg'on to'qisa, jahannamdan o'z o'rnini tayyorlasin"</li>
            <li><strong>Tabaqa mutavotiri</strong> ‚Äî Masalan: Qur'oni Karimning tavoturi</li>
            <li><strong>Amal va meros mutavotiri</strong> ‚Äî Masalan: Besh vaqt namoz, Ramazon ro'zasi</li>
            <li><strong>Umumiy qadr mutavotiri</strong> ‚Äî Masalan: Mo'jizaning tavoturi</li>
          </ul>
        `
      },
      {
        id: 3,
        title: "Mashhur xabar",
        desc: "Ta'rifi, uch asr mezoni, hukmi va istilohdagi farqlar",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <div class="highlight-box">
            <strong>ISTILOHDA:</strong> Mashhur xabar ‚Äî bu birinchi asrda ahod bo'lgan, so'ngra ikkinchi va uchinchi asrlarda ‚Äî ya'ni tobe'inlar va tobe'ut-tobe'inlar davrida mutavotir bo'lgan xabardir.
          </div>

          <p><strong>MUHIM SHART:</strong> Hanafiylar bir ovozdan shuni aytishganki: uch asrdan keyin yuzaga kelgan mashhurlik yoki mutavotirlik e'tiborga olinmaydi!</p>

          <h3>2 ‚Äî Uch asrni belgilash</h3>
          <ul>
            <li><strong>Birinchi asr:</strong> Sahobalar tabaqasi ‚Äî 110-hijriy yilgacha</li>
            <li><strong>Ikkinchi asr:</strong> Tobe'inlar tabaqasi ‚Äî 180-hijriy yilgacha</li>
            <li><strong>Uchinchi asr:</strong> Tobe'ut-tobe'inlar tabaqasi ‚Äî 220-hijriy yilgacha</li>
          </ul>

          <h3>3 ‚Äî Hukmi</h3>
          <div class="highlight-box">
            <strong>HANAFIYLAR NAZARIDA:</strong><br>
            ‚Ä¢ Mashhur xabar mutavotir ham emas, mutavotir hukmida ham emas<br>
            ‚Ä¢ U mutavotir bilan ahod o'rtasidagi darajadir<br>
            ‚Ä¢ U yaqin ehtimolli gumonni beradi ‚Äî "xotirjamlik (·π≠uma'nina)"<br>
            ‚Ä¢ Mashhur xabarni inkor qilgan kishi kofir emas, balki <strong>adashgan (zoll)</strong> hisoblanadi
          </div>

          <h3>4 ‚Äî Muhaddislar istilohida</h3>
          <p>Muhaddislar nazarida: mashhur xabar ‚Äî bu ikki kishidan ortiq yo'l bilan rivoyat qilingan, ammo mutavotir darajasiga yetmagan xabardir.</p>
        `
      },
      {
        id: 4,
        title: "Ahod (Xabarul-vohid) xabarlar",
        desc: "Ta'rifi, hukmi, hudud masalasida qo'llanilishi va Imom Abu Hanifaning fikri",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <div class="highlight-box">
            <strong>ISTILOHDA:</strong> Xabarul-vohid ‚Äî mashhurlik va mutavotir darajasiga yetmagan har qanday xabardir. Uni bitta, ikki yoki uch va undan ko'p kishi rivoyat qilgan bo'lsa ham, agar mashhur yoki mutavotir darajasiga yetmagan bo'lsa, u istilohda xabarul-vohid hisoblanadi.
          </div>

          <h3>2 ‚Äî Hukmi</h3>
          <p><strong>Hanafiylar ittifoqi:</strong> Xabarul-vohid ilm bermaydi, ammo amal qilishni vojib qiladigan kuchli gumonni beradi.</p>
          <p>Imom Saraxsiy: "Bizning mazhabimizda xabarul-vohid amalni vojib qiladi, lekin qat'iy ilmni vojib qilmaydi."</p>

          <h3>3 ‚Äî Hudud (jazolar) masalasida xabarul-vohid</h3>
          <div class="highlight-box">
            <strong>BIRINCHI QARASH (Imom Abu Yusuf, Jassos, Ibn Humom):</strong><br>
            Hudud jazolari xabarul-vohid bilan isbotlanadi. Chunki hudud ‚Äî amaliy shariat hukmi.
          </div>

          <div class="highlight-box">
            <strong>IKKINCHI QARASH (Imom al-Karxiy, Bazdaviy):</strong><br>
            Hudud jazolari xabarul-vohid bilan isbotlanmaydi. Chunki xabarul-vohidda xato va gumon ehtimoli mavjud.
          </div>

          <h3>4 ‚Äî Imom Abu Hanifaning fikri</h3>
          <p>Imom Abu Hanifadan bu masalada aniq matn rivoyat qilinmagan. Keyingi ulamolar ixtilof qilganlar. Rohij fikr ‚Äî birinchi qarash.</p>
        `
      },
      {
        id: 5,
        title: "Aql",
        desc: "Ta'rifi, roviyda shart qilingan aql, balog'at va tahammul masalasi",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <p>Lug'atda: ‚ÄúAql‚Äù ‚Äî to'sish, man qilishdir. Aql shunday atalgan, chunki u egasini noloyiqliklardan to'sadi.</p>
          <p>Istilohda: Aql ‚Äî bu nafsdagi quvvat bo'lib, u orqali inson ilm va idroklarni qabul qilishga tayyor bo'ladi.</p>

          <h3>2 ‚Äî Roviyda shart qilingan aql</h3>
          <p>Hadis rivoyati bobida talab qilinadigan aql ‚Äî to'liq aqldir. To'liq aql esa balog'at bilan hosil bo'ladi.</p>

          <h3>3 ‚Äî Balog'at ‚Äî rivoyatni ado etish sharti</h3>
          <p>Balog'at ‚Äî hadisni ado etish (yetkazish) shartidir, tahammul (eshitib olish) sharti emas.</p>

          <h3>4 ‚Äî Tahammul ma'lum yosh bilan cheklanadimi?</h3>
          <p>Jumhur ulamolar nazarida tahammul ma'lum yosh bilan belgilanmaydi. Mezon ‚Äî tushunish va farqlash qobiliyatidir.</p>
        `
      },
      {
        id: 6,
        title: "Islom",
        desc: "Islom shart qilinishining sababi va rivoyatni ado etish vaqtida shart qilinishi",
        content: `
          <h3>1 ‚Äî Islom shart qilinishining sababi</h3>
          <p>Hadis rivoyatini qabul qilishda ikkinchi shart ‚Äî roviy musulmon bo'lishidir. Shuning uchun kofirning rivoyati hadis bobida qabul qilinmaydi.</p>

          <h3>2 ‚Äî Islom rivoyatni ado etish vaqtida shart qilinadi</h3>
          <p>Roviyning musulmon bo'lishi xabarni ado etish (rivoyat qilish) vaqtida shart qilinadi, tahammul (eshitib olish) vaqtida shart qilinmaydi.</p>
        `
      },
      {
        id: 7,
        title: "Zabt",
        desc: "Ta'rifi, bo'linishi, g'ofil roviy rivoyati va zabtli roviyni tanish",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <p>Istilohda: Zabt ‚Äî hadisni to'g'ri tarzda eshitish, so'ng uning ma'nosini tushunish, keyin uni yodda saqlash va ado etish paytigacha shu holatda barqaror tutishdir.</p>

          <h3>2 ‚Äî Bo'linishi</h3>
          <p>Hanafiy mashoyixlari zabtni ikki turga bo'lishgan: Zohiriy zabt va Botiniy zabt.</p>

          <h3>3 ‚Äî G'ofil roviy rivoyatining hukmi</h3>
          <p>Agar roviyda hushyorlik ustun bo'lsa, g'aflat kam bo'lsa ‚Äî u g'aflatsiz roviy hukmidadir.</p>

          <h3>4 ‚Äî Zabtli roviy qanday taniladi</h3>
          <p>Roviyning zabtli ekanligi ikki narsa bilan aniqlanadi: Shuhrat va Zabtli roviylarga muvofiqligi.</p>
        `
      },
      {
        id: 8,
        title: "Adolat",
        desc: "Ta'rifi, hadis rivoyati bobida adolat, bo'linishi va boshqalar",
        content: `
          <h3>1 ‚Äî Ta'rifi</h3>
          <p>Istilohda: Adolat ‚Äî bu insonni taqvo va muruwwatga doimiy rioya qilishga undaydigan mustahkam sifatdir.</p>

          <h3>2 ‚Äî Hadis rivoyati bobida adolatning ma'nosi</h3>
          <p>Adolatdan maqsad ‚Äî katta gunohlarni tark etish, kichik gunohda turib olmaslik va muruwwatni buzadigan ishlardan saqlanishdir.</p>

          <h3>3 ‚Äî Adolatning bo'linishi</h3>
          <p>Adolatni ikki turga bo'lishgan: Zohiriy adolat va Botiniy adolat.</p>

          <h3>4 ‚Äî Nabi Ô∑∫ ga yolg'on gapirgan kishining rivoyati</h3>
          <p>Agar tavbasi shartlari bilan sobit bo'lsa, tavbadan keyingi rivoyatlari qabul qilinadi (ikkinchi qarash).</p>

          <h3>5 ‚Äî Adolatli roviydan rivoyat qilish ‚Äî uni ta'dil qiladimi?</h3>
          <p>Adolatli roviydan rivoyat qilish ta'dil hisoblanadi, ammo faqat uch asrda.</p>

          <h3>6 ‚Äî Mubham holdagi ta'dil</h3>
          <p>Bu ta'dil yetarli (hanafiylar ko'pchiligi).</p>
        `
      },
      {
        id: 9,
        title: "Bid'atchining rivoyati",
        desc: "Bid'at ta'rifi va bid'atchining rivoyati hukmi",
        content: `
          <h3>1 ‚Äî Bid'atning ta'rifi</h3>
          <p>Istilohda: Bid'at ‚Äî sahobalar va tobe'inlar yo'lida bo'lmagan, shariat dalili talab qilmagan yangilikdir.</p>

          <h3>2 ‚Äî Bid'atchining rivoyati hukmi</h3>
          <p>Birinchisi mazhab: Bid'atchining rivoyati mutlaqo qabul qilinmaydi.</p>
        `
      },
      {
        id: 10,
        title: "Mastur va majhul roviy rivoyati",
        desc: "Ta'rifi, istilohdagi farq va hukmi",
        content: `
          <h3>1 ‚Äî Hanafiylar nazarida ‚Äúmajhul‚Äùning ta'rifi</h3>
          <p>Majhul ‚Äî hadis rivoyati bilan mashhur bo'lmagan, odamlar undan ilm olib yurgani bilan tanilmagan roviydir.</p>

          <h3>2 ‚Äî Muhaddislar istilohi</h3>
          <p>Muhaddislar nazarida majhul al-'ayn va majhul al-hol (mastur) farqlanadi.</p>

          <h3>3 ‚Äî Uch asr roviylaridan bo'lgan mastur roviy rivoyatining hukmi</h3>
          <p>Hanafiylar majhul roviyni besh qismga bo'lishgan, va ularning hukmi tafsilot bilan bayon qilingan.</p>
        `
      }
    ];

    let selectedTopics = [];

    function renderTopics(){
      const topicsList = document.getElementById('topicsList');
      const totalCount = document.getElementById('totalCount');
      totalCount.textContent = topicsData.length;

      topicsList.innerHTML = '';

      topicsData.forEach(topic => {
        const card = document.createElement('div');
        card.className = 'topic-card' + (selectedTopics.includes(topic.id) ? ' selected' : '');

        card.innerHTML = `
          <div class="topic-header" onclick="toggleSelect(${topic.id})">
            <div class="checkbox">${selectedTopics.includes(topic.id) ? '‚úì' : ''}</div>
            <div class="topic-title-section">
              <div class="topic-number">Mavzu ${topic.id}</div>
              <div class="topic-title">${topic.title}</div>
              <div class="topic-desc">${topic.desc}</div>
            </div>
            <button class="expand-btn" onclick="toggleExpand(event, ${topic.id})">+</button>
          </div>

          <div class="topic-content" id="content-${topic.id}">
            <div class="topic-details">${topic.content}</div>
          </div>
        `;

        topicsList.appendChild(card);
      });

      updateSelectedCount();
      updateConclusionButton();
      updateSelectAllText();
      renderSelectedList();
    }

    function toggleSelect(id){
      const index = selectedTopics.indexOf(id);
      if(index > -1) selectedTopics.splice(index, 1);
      else selectedTopics.push(id);

      renderTopics();
    }

    function toggleSelectAll(){
      if(selectedTopics.length === topicsData.length){
        selectedTopics = [];
      } else {
        selectedTopics = topicsData.map(t => t.id);
      }
      renderTopics();
    }

    function updateSelectAllText(){
      const el = document.getElementById('selectAllText');
      el.textContent = (selectedTopics.length === topicsData.length)
        ? '‚úó Hammasini bekor qilish'
        : '‚úì Hammasini tanlash';
    }

    function toggleExpand(event, id){
      event.stopPropagation();

      const content = document.getElementById(`content-${id}`);
      content.classList.toggle('expanded');

      const btn = event.target;
      btn.textContent = content.classList.contains('expanded') ? '-' : '+';
    }

    function updateSelectedCount(){
      document.getElementById('selectedCount').textContent = selectedTopics.length;
    }

    function updateConclusionButton(){
      document.getElementById('conclusionBtn').disabled = selectedTopics.length === 0;
    }

    function showConclusionSection(){
      document.getElementById('topicsContainer').style.display = 'none';
      document.getElementById('conclusionSection').classList.add('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function backToTopics(){
      document.getElementById('topicsContainer').style.display = 'block';
      document.getElementById('conclusionSection').classList.remove('active');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderSelectedList(){
      const list = document.getElementById('selectedTopicsList');
      if(!list) return;

      list.innerHTML = '';
      selectedTopics.forEach(id => {
        const topic = topicsData.find(t => t.id === id);
        const li = document.createElement('li');
        li.textContent = topic ? topic.title : `Mavzu ${id}`;
        list.appendChild(li);
      });
    }

    function safeText(str){
      return (str || '').replace(/\s+/g, ' ').trim();
    }

    async function downloadPDF(){
      const overlay = document.getElementById('loadingOverlay');
      overlay.classList.add('active');

      try{
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ unit: 'mm', format: 'a4' });

        const pageWidth = doc.internal.pageSize.getWidth();
        const marginX = 12;
        const marginTop = 14;
        const maxWidth = pageWidth - marginX * 2;

        let y = marginTop;

        // Title
        doc.setFontSize(16);
        doc.text(safeText(document.querySelector('.header h1')?.textContent), marginX, y);
        y += 8;

        doc.setFontSize(11);
        doc.text(safeText(document.querySelector('.header p')?.textContent), marginX, y);
        y += 10;

        // Selected topics
        doc.setFontSize(13);
        doc.text("Tanlangan mavzular:", marginX, y);
        y += 7;

        doc.setFontSize(11);
        selectedTopics.forEach((id, idx) => {
          const topic = topicsData.find(t => t.id === id);
          const line = `${idx + 1}. ${topic ? topic.title : `Mavzu ${id}`}`;
          const wrapped = doc.splitTextToSize(line, maxWidth);

          wrapped.forEach(wLine => {
            if(y > 285){ doc.addPage(); y = marginTop; }
            doc.text(wLine, marginX, y);
            y += 6;
          });
        });

        y += 6;
        if(y > 285){ doc.addPage(); y = marginTop; }

        // Conclusion
        doc.setFontSize(13);
        doc.text("Xulosa:", marginX, y);
        y += 7;

        doc.setFontSize(11);
        const conclusion = document.getElementById('conclusionText').value || '';
        const paragraphs = conclusion.split('\n');

        paragraphs.forEach(p => {
          const text = p.trim() === '' ? ' ' : p;
          const lines = doc.splitTextToSize(text, maxWidth);

          lines.forEach(line => {
            if(y > 285){ doc.addPage(); y = marginTop; }
            doc.text(line, marginX, y);
            y += 6;
          });
        });

        doc.save("Hadis_xulosa.pdf");
      } catch (e){
        alert("PDF yaratishda xatolik: " + (e?.message || e));
      } finally {
        overlay.classList.remove('active');
      }
    }

    // init
    renderTopics();
  </script>
</body>
</html>
