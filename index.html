<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hadis Ilmi - Mustaqil Ish</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    :root {
      --primary: #4e54c8;
      --secondary: #8f94fb;
      --bg: #f8fbff;
      --white: #ffffff;
      --light: #f0f4ff;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #e0e7ff 0%, #c3dafe 100%);
      min-height: 100vh;
      color: #2c3e50;
      padding: 20px;
    }
    .container { max-width: 900px; margin: 0 auto; padding-bottom: 100px; }
    
    /* ASOSIY STYLES */
    .card {
      background: var(--white);
      border-radius: 15px;
      margin-bottom: 15px;
      padding: 20px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: 0.2s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .card.selected {
      border-color: var(--primary);
      background: #f4f7ff;
    }
    .card-header { display: flex; align-items: center; gap: 15px; font-weight: bold; }
    .check-icon {
      width: 24px; height: 24px; border: 2px solid #ccc; border-radius: 6px;
      display: flex; align-items: center; justify-content: center;
      color: white; transition: 0.2s;
    }
    .card.selected .check-icon { background: var(--primary); border-color: var(--primary); }

    /* BUTTONS */
    .btn {
      padding: 12px 25px; border: none; border-radius: 50px;
      color: white; font-weight: bold; cursor: pointer;
      background: var(--primary); display: inline-flex; align-items: center; gap: 8px;
    }
    .btn:disabled { background: #ccc; cursor: not-allowed; }
    
    /* ACTION BAR */
    .action-bar {
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
      background: white; padding: 15px 30px; border-radius: 50px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      display: flex; gap: 15px; z-index: 100;
    }

    /* EDITOR & INPUTS */
    input[type="text"] {
      width: 100%; padding: 15px; margin-bottom: 20px;
      border: 1px solid #ddd; border-radius: 10px; font-size: 16px;
    }
    .editable-box {
      background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;
      border: 2px dashed #ccc;
    }

    /* LOADER */
    .loader {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(255,255,255,0.98); 
      display: none; flex-direction: column;
      align-items: center; justify-content: center; z-index: 9999;
    }
    .loader.active { display: flex; }
    .spinner {
      width: 50px; height: 50px; border: 5px solid #eee;
      border-top: 5px solid var(--primary); border-radius: 50%;
      animation: spin 1s linear infinite; margin-bottom: 20px;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* --- PDF CONTAINER (MUHIM QISM) --- */
    /* Bu qism oddiy holatda ko'rinmaydi */
    #pdfOutput {
      display: none; 
      background: white;
      width: 750px; /* A4 proporsiyasi uchun fix o'lcham */
      padding: 40px;
      color: black;
      font-family: 'Times New Roman', serif;
    }
    
    /* PDF ichidagi stillar */
    .pdf-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 20px; margin-bottom: 30px; }
    .pdf-topic { margin-bottom: 30px; page-break-inside: auto; }
    .pdf-title { color: #000; font-size: 16pt; font-weight: bold; margin-bottom: 10px; }
    .pdf-text { font-size: 12pt; line-height: 1.5; text-align: justify; }
    .pdf-highlight { 
        background-color: #f0f0f0; 
        padding: 10px; 
        border-left: 3px solid #000; 
        margin: 10px 0; 
        font-weight: bold;
    }

  </style>
</head>
<body>

  <div class="loader" id="loader">
    <div class="spinner"></div>
    <h3>PDF tayyorlanmoqda...</h3>
  </div>

  <div class="container" id="appContainer">
    <div style="text-align:center; margin-bottom:30px;">
      <h1 style="color:var(--primary);">ğŸ“š Hadis Ilmi - Mustaqil Ish</h1>
    </div>

    <input type="text" id="studentName" placeholder="F.I.O va Guruhingizni yozing (Masalan: Aliyev Vali, 304-guruh)" />

    <div id="selectionSection">
      <div id="topicsContainer"></div>
      <div class="action-bar">
        <button class="btn" onclick="toggleSelectAll()">Hammasi</button>
        <button class="btn" id="nextBtn" onclick="goToEditor()" disabled>Davom etish</button>
      </div>
    </div>

    <div id="editorSection" style="display:none;">
      <div id="editorContainer"></div>
      
      <div class="editable-box">
        <h4>Xulosa:</h4>
        <div id="finalConclusion" contenteditable="true">
          Ushbu mavzularni o'rganib, men hadis ilmining nozik jihatlarini tushundim...
        </div>
      </div>

      <div class="action-bar">
        <button class="btn" style="background:#777" onclick="backToSelection()">Ortga</button>
        <button class="btn" onclick="generatePDF()">PDF YUKLAB OLISH</button>
      </div>
    </div>
  </div>

  <div id="pdfWrapper" style="position: absolute; top: 0; left: 0; width: 100%; z-index: -1;">
     <div id="pdfOutput"></div>
  </div>

  <script>
    // DATA
    const topics = [
  {
    id: 1,
    title: "1. Hanafiylarning taqsimoti",
    content: `
      <h3>Hanafiylarning taqsimoti (ittisol jihatidan)</h3>
      <p>Hanafiylar xabarlarni Rasululloh ï·º ga bogâ€˜lanish (ittisol) va xabarning tarqalish darajasiga qarab 3 qismga boâ€˜ladilar:</p>
      <ul>
        <li><b>Mutavotir</b> â€” surat va maâ€™no jihatidan shubhasiz.</li>
        <li><b>Mashhur</b> â€” <u>1-asrda ahod</u>, <u>2â€“3-asrda mutavotir darajaga chiqqan</u>.</li>
        <li><b>Ahod (xabarul-vohid)</b> â€” mutavotir ham emas, mashhur ham emas.</li>
      </ul>
      <div class="pdf-highlight">Hanafiylarda â€œmashhurâ€ alohida kategoriya (shunchaki â€œahod turlariâ€ emas).</div>
    `
  },

  {
    id: 2,
    title: "2. Muhaddislarning taqsimoti",
    content: `
      <h3>Muhaddislarning taqsimoti</h3>
      <p>Koâ€˜pchilik muhaddislarda xabarlar 2 qism:</p>
      <ul>
        <li><b>Mutavotir</b></li>
        <li><b>Ahod</b> (xabarul-vohid)</li>
      </ul>
      <p>Soâ€˜ng ahodni 3 koâ€˜rinishga boâ€˜lishadi:</p>
      <ul>
        <li><b>Mashhur</b></li>
        <li><b>Aziz</b></li>
        <li><b>Gâ€˜arib</b></li>
      </ul>
    `
  },

  {
    id: 3,
    title: "3. Ikki istilohni solishtirish",
    content: `
      <h3>Hanafiy istilohi vs Muhaddis istilohi</h3>
      <table class="comparison-table">
        <tr><th>Masala</th><th>Hanafiylar</th><th>Muhaddislar</th></tr>
        <tr>
          <td>Mashhur</td>
          <td>1-asr ahod, 2â€“3-asrda mutavotir darajaga chiqadi</td>
          <td>Mutavotirga yetmagan, ammo 2+ yoâ€˜l bilan kelgan</td>
        </tr>
        <tr>
          <td>Ahod</td>
          <td>Mashhurga kirmagan hamma narsa</td>
          <td>Mutavotir shartlari toâ€˜liq boâ€˜lmagan xabar</td>
        </tr>
        <tr>
          <td>Mutavotir</td>
          <td>Ilm hosil boâ€˜lishi mezon, hanafiylarda uch asr chegarasi bor</td>
          <td>Koâ€˜plik + shartlar toâ€˜plami</td>
        </tr>
      </table>
      <div class="pdf-highlight">Muammo koâ€˜p joyda shu: odamlar muhaddislar kitobidagi â€œmajhulâ€ hukmini hanafiylarga koâ€˜chirib yuborib yuborishadi.</div>
    `
  },

  {
    id: 4,
    title: "4. Mutavotir ta'rifi",
    content: `
      <h3>Mutavotir taâ€™rifi</h3>
      <p><b>Lugâ€˜atda:</b> tavotur â€” ketma-ket kelish (orasida oraliq boâ€˜lishi ham mumkin).</p>
      <p><b>Istilohda:</b> Ibn as-Saâ€™atiy: <b>â€œOâ€˜z-oâ€˜zidan ilmni hosil qiladigan jamoa xabari.â€</b></p>
      <div class="pdf-highlight">â€œIlmni oâ€˜z-oâ€˜zidanâ€ â€” tashqi dalil bilan tasdiqlanadigan xabarlarni chiqarib tashlash uchun.</div>
    `
  },

  {
    id: 5,
    title: "5. Mutavotir shartlari",
    content: `
      <h3>Mutavotir shartlari</h3>
      <ol>
        <li><b>Koâ€˜plik</b>: ataylab yolgâ€˜onda kelishib olish odatda imkonsiz boâ€˜ladigan daraja.</li>
        <li><b>Tabaqalarda davomiylik</b>: isnod tabaqalarida bu hol ketma-ket boâ€˜lsin (hanafiy mezoni: uch asr).</li>
        <li><b>His (sezgi)ga asoslanish</b>: xabar mazmuni hissiy boâ€˜lsin; sof aqliy masala boâ€˜lmasin.</li>
      </ol>
    `
  },

  {
    id: 6,
    title: "6. Mutavotir hukmi",
    content: `
      <h3>Mutavotirning hukmi</h3>
      <div class="pdf-highlight">
        Mutavotir xabar <b>zaruriy ilm</b> beradi. Uni inkor qilgan kishi <b>kofir</b> boâ€˜ladi.
      </div>
      <p>QozÄ± Iso ibn Aban: mutavotirni rad etish â€” Rasululloh ï·º ni rad etgandek boâ€˜lishi mumkin.</p>
    `
  },

  {
    id: 7,
    title: "7. Mutavotir turlari",
    content: `
      <h3>Mutavotir turlari</h3>
      <p>Muhaddislar koâ€˜proq: <b>lafziy</b> va <b>maâ€™naviy</b> deydi.</p>
      <p>Imom Kashmiri taqsimoti (kengroq):</p>
      <ul>
        <li><b>Isnod mutavotiri</b></li>
        <li><b>Tabaqa mutavotiri</b></li>
        <li><b>Amal va meros mutavotiri</b></li>
        <li><b>Umumiy qadr mutavotiri</b></li>
      </ul>
    `
  },

  {
    id: 8,
    title: "8. Mashhur ta'rifi",
    content: `
      <h3>Mashhur taâ€™rifi (Hanafiy istilohida)</h3>
      <p><b>Mashhur</b> â€” <u>1-asrda ahod</u> boâ€˜lgan, keyin <u>2â€“3-asrda</u> tarqalib <u>mutavotir darajaga</u> chiqqan xabar.</p>
      <div class="pdf-highlight">Hanafiylarda mashhurlik â€œkeyingi asrlardaâ€ chiqsa, bu istilohda mashhur hisoblanmasligi mumkin.</div>
    `
  },

  {
    id: 9,
    title: "9. Uch asr chegarasi",
    content: `
      <h3>Uch asr chegarasi (Hanafiy mezoni)</h3>
      <p>Hanafiylarda mutavotir/mashhur bahosida asosiy eâ€™tibor:</p>
      <ul>
        <li><b>1-asr:</b> sahobalar</li>
        <li><b>2-asr:</b> tobiâ€˜in</li>
        <li><b>3-asr:</b> tobiâ€˜ut-tobiâ€˜in</li>
      </ul>
      <p>Uch asrdan keyingi â€œtarqalib ketdiâ€ degan mashhurlik/mutavotirlik â€” hanafiy usulida koâ€˜pincha hal qiluvchi mezon boâ€˜lib qolmaydi.</p>
    `
  },

  {
    id: 10,
    title: "10. Mashhur hukmi",
    content: `
      <h3>Mashhur xabarning hukmi</h3>
      <p>Hanafiylarning koâ€˜pchilik qarashi: mashhur xabar <b>tumaâ€™nina (xotirjamlik)</b> beradi.</p>
      <div class="pdf-highlight">
        Mashhur â€” qalbni asosan tinch qiladi, lekin 1-asrda ahod boâ€˜lgani sababli ozgina ehtimoliy shubha qoladi.
        Shu sabab uni inkor qilgan kishi odatda <b>kofir</b> deyilmaydi, <b>adashgan</b> deyiladi.
      </div>
    `
  },

  {
    id: 11,
    title: "11. Ahod ta'rifi",
    content: `
      <h3>Ahod (xabarul-vohid) taâ€™rifi</h3>
      <p><b>Lugâ€˜atda:</b> bitta kishi rivoyat qilgan.</p>
      <p><b>Istilohda (Hanafiylar):</b> mutavotir ham, mashhur ham boâ€˜lmagan har qanday xabar (1 kishi boâ€˜lsa ham, 3 kishi boâ€˜lsa ham â€” mashhur/mutavotir darajaga yetmasa ahod).</p>
    `
  },

  {
    id: 12,
    title: "12. Ahod hukmi",
    content: `
      <h3>Ahod xabarning hukmi</h3>
      <div class="pdf-highlight">
        Ahod xabar (shartlari boâ€˜lsa) <b>ilm bermaydi</b>, lekin <b>amal qilishni vojib qiladigan zann</b> beradi.
      </div>
      <p>Xabarul-vohid bilan amal: agar u vojiblikka dalolat qilsa va toâ€˜sqinlik boâ€˜lmasa â€” amal qilinadi; mansux boâ€˜lsa yoki toâ€˜sqinlik boâ€˜lsa â€” amal qilinmaydi.</p>
    `
  },

  {
    id: 13,
    title: "13. Hudud masalasi",
    content: `
      <h3>Hudud (jazolar) masalasida xabarul-vohid</h3>
      <p>Hanafiy imomlari orasida ixtilof bor:</p>
      <ul>
        <li><b>1-qarash:</b> hudud â€” amaliy hukm; ahod amaliy hukmda amalni vojib qiladi â†’ hudud ahod bilan sobit boâ€˜ladi.</li>
        <li><b>2-qarash:</b> hudud ahod bilan sobit boâ€˜lmaydi (Karkhiy va boshqalar tanlagan qarash).</li>
      </ul>
      <div class="pdf-highlight">Rojih (kuchli) sifatida matnda 1-qarash kuchliroq deb keladi.</div>
    `
  },

  {
    id: 14,
    title: "14. Aql sharti",
    content: `
      <h3>Aql sharti</h3>
      <p><b>Lugâ€˜atda:</b> aql â€” toâ€˜sish/man qilish. â€œIqolâ€ (tuyani bogâ€˜lash arqoni) shu ildizdan.</p>
      <p><b>Maâ€™no:</b> roviy eshitganini tushunish va saqlashga qodir boâ€˜lsin.</p>
    `
  },

  {
    id: 15,
    title: "15. Balog'at - ado sharti",
    content: `
      <h3>Balogâ€˜at: ado (rivoyat qilish) vaqtida shart</h3>
      <div class="pdf-highlight">
        Balogâ€˜at koâ€˜pincha <b>ado</b> (rivoyat qilish) paytida shart qilinadi.
      </div>
      <p>Yaâ€™ni: bola eshitib olishi (tahammul) mumkin, lekin rivoyatni yetkazish (ado) uchun balogâ€˜at masalasi alohida koâ€˜riladi.</p>
    `
  },

  {
    id: 16,
    title: "16. Tahammul yoshi",
    content: `
      <h3>Tahammul (eshitib olish) yoshi</h3>
      <p><b>Jumhur:</b> tahammul aniq yosh bilan chegaralanmaydi.</p>
      <div class="pdf-highlight">
        Mezon â€” tushunish va farqlash qobiliyati.
        Tushunsa: 5 yoshdan kichik boâ€˜lsa ham sahih.
        Tushunmasa: katta boâ€˜lsa ham sahih emas.
      </div>
      <p>Ibn Humom ham: mezon â€” gapni tushunish va javob bera olish, deydi.</p>
    `
  },

  {
    id: 17,
    title: "17. Islom sharti",
    content: `
      <h3>Islom sharti</h3>
      <p>Hadis rivoyatini qabul qilishdagi shartlardan biri: roviy <b>musulmon boâ€˜lishi</b>.</p>
    `
  },

  {
    id: 18,
    title: "18. Islom - ado vaqtida",
    content: `
      <h3>Islom sharti qachon talab qilinadi?</h3>
      <div class="pdf-highlight">
        Islom sharti <b>ado</b> (rivoyat qilish) vaqtida shart qilinadi,
        <b>tahammul</b> (eshitib olish) vaqtida emas.
      </div>
      <p>Yaâ€™ni: bir kishi eshitgan payti musulmon boâ€˜lmasa ham, keyin Islomga kirib rivoyat qilsa â€” koâ€˜pchilik qarashlarda rivoyati koâ€˜riladi.</p>
    `
  },

  {
    id: 19,
    title: "19. Zabt ta'rifi",
    content: `
      <h3>Zabt taâ€™rifi</h3>
      <p><b>Lugâ€˜atda:</b> mahkam ushlash.</p>
      <p><b>Istilohda:</b> eshitganini <b>tahrif/tashif qilmay</b> saqlash, xato va gâ€˜aflat ustun boâ€˜lib ketmasligi.</p>
      <div class="pdf-highlight">Agar xato/gâ€˜aflat ustun boâ€˜lsa â€” roviydan hadis olinmaydi, chunki zabtga â€œishonchli zannâ€ hosil boâ€˜lmaydi.</div>
    `
  },

  {
    id: 20,
    title: "20. Zabt turlari",
    content: `
      <h3>Zabt turlari</h3>
      <p>Hanafiy mashoyixlari zabtni 2 turga boâ€˜ladi:</p>
      <ul>
        <li><b>Zohiriy zabt</b> â€” lafzni tahrif va tashifsiz saqlash (talaffuz/yozuv xatolariga yoâ€˜l qoâ€˜ymaslik).</li>
        <li><b>Botiniy zabt</b> â€” maâ€™noni ham toâ€˜gâ€˜ri anglash, fiqhiy noziklikda adashmaslik.</li>
      </ul>
    `
  },

  {
    id: 21,
    title: "21. G'ofil roviy",
    content: `
      <h3>Gâ€˜ofil roviy (beparvo / chalgâ€˜uvchan)</h3>
      <p>Agar roviyda gâ€˜aflat koâ€˜p boâ€˜lsa, rivoyatda koâ€˜p chalkashsa â€” zabt zaiflashadi.</p>
      <div class="pdf-highlight">Zabt va buzilish teng boâ€˜lib qolsa yoki gâ€˜aflat ustun boâ€˜lsa â€” rivoyat qabul qilinmaydi.</div>
    `
  },

  {
    id: 22,
    title: "22. Zabtli roviy tanish",
    content: `
      <h3>Zabtli roviy qanday taniladi?</h3>
      <ul>
        <li>Ishonchli roviylarga muvofiq kelishi</li>
        <li>Koâ€˜p xato qilmasligi</li>
        <li>Lafz/maâ€™noda tahrif va tasâ€™hifga yoâ€˜l qoâ€˜ymasligi</li>
        <li>Rivoyatlari barqaror boâ€˜lishi</li>
      </ul>
    `
  },

  {
    id: 23,
    title: "23. Adolat ta'rifi",
    content: `
      <h3>Adolat taâ€™rifi</h3>
      <p><b>Lugâ€˜atda:</b> adl â€” toâ€˜gâ€˜rilik/ogâ€˜ishmaslik.</p>
      <p><b>Istilohda:</b> roviyda din va muruwwat (shaâ€™n) jihatidan ishonchlilik boâ€˜lsin.</p>
    `
  },

  {
    id: 24,
    title: "24. Hadisda adolat",
    content: `
      <h3>Hadis qabulida adolat</h3>
      <p>Hadisni dalil qilishda roviy <b>adolatli</b> boâ€˜lishi shart â€” yolgâ€˜on, fisq, muruwwatni yiqituvchi ishlar rivoyat ishonchini buzadi.</p>
    `
  },

  {
    id: 25,
    title: "25. Adolat turlari",
    content: `
      <h3>Adolat turlari (amaliy tasnif)</h3>
      <ul>
        <li><b>Zohir adolat</b> â€” tashqi koâ€˜rinishda solih, ochiq fisqi yoâ€˜q.</li>
        <li><b>Botin adolat</b> â€” tekshiruv/tajriba bilan mustahkamlangan ishonchlilik.</li>
      </ul>
      <div class="pdf-highlight">Keyin majhul/mastur bobida aynan shu farqlar juda ishlaydi.</div>
    `
  },

  {
    id: 26,
    title: "26. Nabiyga yolg'on",
    content: `
      <h3>Nabiy ï·º ga yolgâ€˜on nisbat berish</h3>
      <p>Rasululloh ï·º ga ataylab yolgâ€˜on toâ€˜qish â€” eng katta jinoyat.</p>
      <div class="pdf-highlight">Hadis ilmidagi adolat va zabt shartlarining ildizi shu: Nabiy ï·º ga yolgâ€˜on aralashmasin.</div>
    `
  },

  {
    id: 27,
    title: "27. Adolatli roviydan rivoyat",
    content: `
      <h3>Adolatli roviydan rivoyat</h3>
      <p>Adolatli, zabtli roviydan rivoyat olinadi.</p>
      <p>Ammo bir masala bor: roviy adolatli boâ€˜lsa ham zabt zaif boâ€˜lsa â€” rivoyat olinmaydi (ikkalasi ham kerak).</p>
    `
  },

  {
    id: 28,
    title: "28. Mubham ta'dil",
    content: `
      <h3>Mubham taâ€™dil (noaniq maqtov)</h3>
      <p>â€œU ishonchliâ€ deb umumiy aytish baâ€™zan yetmaydi: kim aytdi? qaysi mezon bilan? qaysi darajada?</p>
      <div class="pdf-highlight">Taâ€™dil aniq boâ€˜lsa â€” roviy bahosi mustahkam; mubham boâ€˜lsa â€” tekshirishga ehtiyoj kuchayadi.</div>
    `
  },

  {
    id: 29,
    title: "29. Bid'at ta'rifi",
    content: `
      <h3>Bidâ€™at taâ€™rifi</h3>
      <p>Bidâ€™at â€” din nomidan aslda dalili boâ€˜lmagan eâ€™tiqod yoki amalni kiritish.</p>
    `
  },

  {
    id: 30,
    title: "30. Bid'atchi rivoyati",
    content: `
      <h3>Bidâ€™atchi roviyning rivoyati</h3>
      <ul>
        <li><b>Kufrga olib boruvchi bidâ€™at</b> â€” rivoyat rad.</li>
        <li><b>Kufrga olib bormaydigan bidâ€™at</b> â€” yolgâ€˜onchi boâ€˜lmasa, targâ€˜ibchi boâ€˜lmasa va rivoyat bidâ€™atini kuchaytirmasa â†’ rivoyat olinishi mumkin.</li>
      </ul>
      <div class="pdf-highlight">Mezon: â€œyolgâ€˜onâ€ va â€œbidâ€™atni yoyishâ€ xavfi.</div>
    `
  },

  {
    id: 31,
    title: "31. Buxoriy va xorijiylar",
    content: `
      <h3>Buxoriy va xorijiylar</h3>
      <p>Matnda Abdulaziz al-Buxoriydan mazmun keladi: â€œHadisda eng sahih boâ€˜lganlar â€” xorijiylarâ€ degan gap zikr qilinadi.</p>
      <p>Maâ€™no: agar roviy yolgâ€˜onning haromligiga eâ€™tiqod qilsa, zabtli va taqvodor boâ€˜lsa, sahihlik qalbda mustahkam boâ€˜lsa â€” salaf baâ€™zan undan hadis olgan.</p>
      <div class="pdf-highlight">Bu: â€œqoidalar kerak emasâ€ degani emas â€” qoidalar koâ€˜r odamning hassasiga oâ€˜xshaydi, yoâ€˜l koâ€˜rsatadi.</div>
    `
  },

  {
    id: 32,
    title: "32. Majhul - kirish",
    content: `
      <h3>Majhul/mastur bobiga kirish (Hanafiy istilohi)</h3>
      <p>Bu bobda hanafiylarda maxsus istiloh bor. Hanafiy usuliga chuqur kirmagan odam uchun chalkash koâ€˜rinadi.</p>
      <div class="pdf-highlight">
        Muhammad â€˜Avvoma: odamlar muhaddislar kitobidan â€œmajhul radâ€ hukmini olib, hanafiy dalillariga tatbiq qildilar â†’ hukmlar aralashdi. Farqlash zarur.
      </div>
    `
  },

  {
    id: 33,
    title: "33. Roviylarning 3 toifasi",
    content: `
      <h3>Roviylarni toifalash (mazkur bobdagi asos)</h3>
      <p>Matnda roviylar â€œhujjat boâ€˜ladigan roviylarâ€ doirasida boâ€˜linadi:</p>
      <ul>
        <li><b>Maâ€™lum roviy</b> (2 tur):
          <ul>
            <li>fiqh va ijtihod bilan tanilgan</li>
            <li>fiqh/fatvo bilan emas, rivoyat bilan tanilgan</li>
          </ul>
        </li>
        <li><b>Majhul roviy</b> â€” 5 xil holatda boâ€˜ladi (keyingi boâ€˜limlarda).</li>
      </ul>
    `
  },

  {
    id: 34,
    title: "34. Hanafiylar nazarida majhul",
    content: `
      <h3>Hanafiylar nazarida â€œmajhulâ€ taâ€™rifi</h3>
      <p>Hanafiylarda â€œmajhulâ€ doimo muhaddislar istilohidagi majhul bilan bir xil emas.</p>
      <div class="pdf-highlight">Shuning uchun hanafiy dalilini muhaddislar â€œmajhulâ€ qoidasi bilan avtomatik urib tashlash â€” xato natijaga olib keladi.</div>
    `
  },

  {
    id: 35,
    title: "35. Majhulga misollar",
    content: `
      <h3>Majhulga misollar</h3>
      <p>Majhul al-â€˜ayn: faqat bitta kishi rivoyat qiladi va boshqalar uni tanimaydi.</p>
      <p>Majhul al-hal: shaxsi maâ€™lum, lekin adolat/zabt holati nomaâ€™lum.</p>
    `
  },

  {
    id: 36,
    title: "36. Mastur = Majhul",
    content: `
      <h3>Mastur va majhul munosabati</h3>
      <p>Koâ€˜p manbalarda mastur â€” â€œholati yashirinâ€ boâ€˜lgani uchun majhulga yaqin turadi.</p>
      <div class="pdf-highlight">Hanafiylar baâ€™zi holatda masturga kengroq qaraydi; muhaddislar koâ€˜pincha zaiflik tomonga ogâ€˜diradi.</div>
    `
  },

  {
    id: 37,
    title: "37. Muhaddislar istilohi",
    content: `
      <h3>Muhaddislar istilohida majhul</h3>
      <p>Muhaddislar majhul/mastur roviy rivoyatini odatda <b>zaif</b> deb baholaydi, chunki tekshirilmagan roviyda ishonch hosil boâ€˜lmaydi.</p>
    `
  },

  {
    id: 38,
    title: "38. Majhul 5 qismi - 1,2",
    content: `
      <h3>Majhulning 5 qismi (1â€“2)</h3>
      <ol>
        <li><b>(1-holat)</b> â€” maâ€™lum roviy boâ€˜lish mezonlariga tushmaydigan, ishonchi kuchli boâ€˜lmagan holat.</li>
        <li><b>(2-holat)</b> â€” rivoyat qilgan, lekin tanilish darajasi yetarli boâ€˜lmagan holat.</li>
      </ol>
      <div class="pdf-highlight">Bu boâ€˜limlar matnda â€œmajhul 5 xil holatâ€ deb keladi; keyingi boâ€˜limlarda davom etadi.</div>
    `
  },

  {
    id: 39,
    title: "39. Majhul 5 qismi - 3",
    content: `
      <h3>Majhulning 5 qismi (3)</h3>
      <p><b>(3-holat)</b> â€” roviy zabt/yod bilan tanilgan boâ€˜lsa ham, fiqh va ijtihod bilan tanilmagan toifa doirasidagi nozik farqlar.</p>
      <div class="pdf-highlight">Bu yerda â€œroviy qaysi tabaqada va qanday tanilgan?â€ degan savol hal qiluvchi boâ€˜ladi.</div>
    `
  },

  {
    id: 40,
    title: "40. Majhul 5 qismi - 4,5",
    content: `
      <h3>Majhulning 5 qismi (4â€“5)</h3>
      <p><b>(4â€“5-holat)</b> â€” majhullik darajasi kuchliroq boâ€˜lgan holatlar: tanilmaganlik, tekshiruv yoâ€˜qligi, rivoyatdagi ziddiyatlar va h.k.</p>
      <div class="pdf-highlight">Bu boâ€˜limlarda mezon â€” â€œhujjat boâ€˜lishâ€ga yetadimi-yoâ€˜qmi. Yetmasa: rad yoki ehtiyotli muomala.</div>
    `
  },

  {
    id: 41,
    title: "41. Saraxsiy bayoni",
    content: `
      <h3>Saraxsiy bayoni</h3>
      <p>Matnda Saraxsiydan mazmun keladi: salaf davrida adolat zohirga qarab qabul qilingan,
      lekin rivoyat mashhur boâ€˜lmagani sabab â€œvahmâ€ ehtimoli qoladi.</p>
      <div class="pdf-highlight">Shu sabab: baâ€™zi xabarlar bilan amal â€œvojibâ€ emas, lekin â€œjoizâ€ boâ€˜lishi mumkin (qiyosga mos kelsa).</div>
    `
  },

  {
    id: 42,
    title: "42. Abu Hanifa va mastur",
    content: `
      <h3>Abu Hanifa va mastur roviy</h3>
      <p>Hanafiylar yoâ€˜lida (xususan Abu Hanifa atrofidagi uslubda) tashqi adolat (zohir)ga qarab roviyga muomala qilish koâ€˜proq uchraydi,
      lekin bu â€œhar narsani koâ€˜r-koâ€˜rona qabul qilishâ€ degani emas.</p>
      <div class="pdf-highlight">Asos: qatâ€™iy dalil (Kitob/mutavotir) zanniy dalildan (ahod) ustun qoâ€˜yiladi.</div>
    `
  },

  {
    id: 43,
    title: "43. Xulosa - Majhul mana shu taqsimotlar",
    content: `
      <h3>Xulosa: Majhul/mastur masalasida nima yodda qolsin?</h3>
      <ol>
        <li>Hanafiy â€œmajhulâ€i bilan muhaddis â€œmajhulâ€i doim bir xil emas.</li>
        <li>Odamlar koâ€˜p xato qiladi: muhaddis hukmini hanafiy dalillariga koâ€˜chirib yuborishadi.</li>
        <li>Hanafiylarda: roviy â€œmaâ€™lumâ€ boâ€˜lishi ham 2 yoâ€˜l (fiqh/ijtihod yoki rivoyat bilan tanilish).</li>
        <li>Majhul esa 5 holatga boâ€˜linadi â€” baho shunga qarab oâ€˜zgaradi.</li>
        <li>Qatâ€™iy dalil (Kitob/mutavotir/mashhur) zanniy dalildan ustun.</li>
      </ol>
      <div class="pdf-highlight">Agar xohlasang, men shu 5 holatni â€œdiagrammaâ€ (mindmap) qilib ham berib qoâ€˜yaman.</div>
    `
  }
];

    let selected = [];
    let edits = {};

    // 1. DASTURNI YURGIZISH
    window.addEventListener('DOMContentLoaded', () => {
      const cont = document.getElementById('topicsContainer');
      cont.innerHTML = topics.map(t => `
        <div class="card" id="card-${t.id}" onclick="toggle(${t.id})">
          <div class="card-header">
            <div class="check-icon" id="check-${t.id}"><i class="fa fa-check"></i></div>
            <span>${t.id}. ${t.title}</span>
          </div>
        </div>
      `).join('');
    });

    // 2. LOGIKA
    function toggle(id) {
      if(selected.includes(id)) selected = selected.filter(x => x !== id);
      else selected.push(id);
      
      // UI yangilash
      topics.forEach(t => {
         const el = document.getElementById(`card-${t.id}`);
         const ic = document.getElementById(`check-${t.id}`);
         if(selected.includes(t.id)) {
           el.classList.add('selected');
           ic.style.background = '#4e54c8';
           ic.style.borderColor = '#4e54c8';
         } else {
           el.classList.remove('selected');
           ic.style.background = 'transparent';
           ic.style.borderColor = '#ccc';
         }
      });
      document.getElementById('nextBtn').disabled = selected.length === 0;
    }

    function toggleSelectAll() {
      if(selected.length === topics.length) selected = [];
      else selected = topics.map(t => t.id);
      
      // UI Update (oddiyroq yo'l bilan)
      topics.forEach(t => {
         // Force update visuals
         const el = document.getElementById(`card-${t.id}`);
         const ic = document.getElementById(`check-${t.id}`);
         if(selected.includes(t.id)) {
           el.classList.add('selected');
           ic.style.background = '#4e54c8';
         } else {
           el.classList.remove('selected');
           ic.style.background = 'transparent';
         }
      });
      document.getElementById('nextBtn').disabled = selected.length === 0;
    }

    function goToEditor() {
      const name = document.getElementById('studentName').value;
      if(!name) return alert("Ismingizni kiriting!");

      document.getElementById('selectionSection').style.display = 'none';
      document.getElementById('editorSection').style.display = 'block';

      const cont = document.getElementById('editorContainer');
      cont.innerHTML = '';
      
      selected.sort((a,b)=>a-b).forEach(id => {
        const t = topics.find(x => x.id === id);
        const div = document.createElement('div');
        div.className = 'editable-box';
        div.innerHTML = `
          <h4 style="color:#888; margin-bottom:10px">${t.title}</h4>
          <div id="edit-${id}" contenteditable="true" style="outline:none">${edits[id] || t.content}</div>
        `;
        cont.appendChild(div);
      });
    }

    function backToSelection() {
      document.getElementById('selectionSection').style.display = 'block';
      document.getElementById('editorSection').style.display = 'none';
    }

    // --- PDF GENERATSIYA (TUZATILGAN) ---
    function generatePDF() {
      // 1. Ma'lumotlarni saqlash
      selected.forEach(id => {
        const el = document.getElementById(`edit-${id}`);
        if(el) edits[id] = el.innerHTML;
      });
      const conclusion = document.getElementById('finalConclusion').innerHTML;
      const name = document.getElementById('studentName').value;

      // 2. PDF shablonini to'ldirish
      const output = document.getElementById('pdfOutput');
      output.innerHTML = `
        <div class="pdf-header">
          <h1>MUSTAQIL ISH</h1>
          <h3>Mavzu: Hadis ilmi (Mustalahul hadis)</h3>
          <p style="margin-top:15px"><strong>Bajardi:</strong> ${name}</p>
          <p><strong>Sana:</strong> ${new Date().toLocaleDateString()}</p>
        </div>
      `;

      selected.forEach(id => {
        const t = topics.find(x => x.id === id);
        output.innerHTML += `
          <div class="pdf-topic">
            <div class="pdf-title">${t.id}. ${t.title}</div>
            <div class="pdf-text">${edits[id] || t.content}</div>
          </div>
        `;
      });

      output.innerHTML += `
        <div style="margin-top:40px; border-top:2px solid #000; padding-top:20px;">
          <h3>XULOSA</h3>
          <div class="pdf-text">${conclusion}</div>
        </div>
      `;

      // 3. GENERATSIYA JARAYONI
      const loader = document.getElementById('loader');
      loader.classList.add('active');

      // SIR SHU YERDA: Elementni ko'rinadigan qilamiz, lekin ustidan loader yopib turadi
      output.style.display = 'block';
      
      const opt = {
        margin:       15,
        filename:     `${name.replace(/\s/g, '_')}_Mustaqil_Ish.pdf`,
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2, useCORS: true },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };

      // Brauzer render qilishi uchun ozgina vaqt beramiz
      setTimeout(() => {
        html2pdf().set(opt).from(output).save().then(() => {
          loader.classList.remove('active');
          output.style.display = 'none'; // Qaytarib yashiramiz
          alert("PDF Muvaffaqiyatli yuklandi!");
        }).catch(err => {
          loader.classList.remove('active');
          output.style.display = 'none';
          alert("Xatolik: " + err.message);
        });
      }, 500);
    }
  </script>
</body>
</html>
