<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hadis Ilmi - Mustaqil Ish</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    :root {
      --primary: #4e54c8;
      --secondary: #8f94fb;
      --bg: #f8fbff;
      --white: #ffffff;
      --light: #f0f4ff;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #e0e7ff 0%, #c3dafe 100%);
      min-height: 100vh;
      color: #2c3e50;
      padding: 20px;
    }
    .container { max-width: 900px; margin: 0 auto; padding-bottom: 100px; }
    
    /* ASOSIY STYLES */
    .card {
      background: var(--white);
      border-radius: 15px;
      margin-bottom: 15px;
      padding: 20px;
      border: 2px solid transparent;
      cursor: pointer;
      transition: 0.2s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .card.selected {
      border-color: var(--primary);
      background: #f4f7ff;
    }
    .card-header { display: flex; align-items: center; gap: 15px; font-weight: bold; }
    .check-icon {
      width: 24px; height: 24px; border: 2px solid #ccc; border-radius: 6px;
      display: flex; align-items: center; justify-content: center;
      color: white; transition: 0.2s;
    }
    .card.selected .check-icon { background: var(--primary); border-color: var(--primary); }

    /* BUTTONS */
    .btn {
      padding: 12px 25px; border: none; border-radius: 50px;
      color: white; font-weight: bold; cursor: pointer;
      background: var(--primary); display: inline-flex; align-items: center; gap: 8px;
    }
    .btn:disabled { background: #ccc; cursor: not-allowed; }
    
    /* ACTION BAR */
    .action-bar {
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
      background: white; padding: 15px 30px; border-radius: 50px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      display: flex; gap: 15px; z-index: 100;
    }

    /* EDITOR & INPUTS */
    input[type="text"] {
      width: 100%; padding: 15px; margin-bottom: 20px;
      border: 1px solid #ddd; border-radius: 10px; font-size: 16px;
    }
    .editable-box {
      background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;
      border: 2px dashed #ccc;
    }

    /* LOADER */
    .loader {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(255,255,255,0.98); 
      display: none; flex-direction: column;
      align-items: center; justify-content: center; z-index: 9999;
    }
    .loader.active { display: flex; }
    .spinner {
      width: 50px; height: 50px; border: 5px solid #eee;
      border-top: 5px solid var(--primary); border-radius: 50%;
      animation: spin 1s linear infinite; margin-bottom: 20px;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* --- PDF CONTAINER (MUHIM QISM) --- */
    /* Bu qism oddiy holatda ko'rinmaydi */
    #pdfOutput {
      display: none; 
      background: white;
      width: 750px; /* A4 proporsiyasi uchun fix o'lcham */
      padding: 40px;
      color: black;
      font-family: 'Times New Roman', serif;
    }
    
    /* PDF ichidagi stillar */
    .pdf-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 20px; margin-bottom: 30px; }
    .pdf-topic { margin-bottom: 30px; page-break-inside: auto; }
    .pdf-title { color: #000; font-size: 16pt; font-weight: bold; margin-bottom: 10px; }
    .pdf-text { font-size: 12pt; line-height: 1.5; text-align: justify; }
    .pdf-highlight { 
        background-color: #f0f0f0; 
        padding: 10px; 
        border-left: 3px solid #000; 
        margin: 10px 0; 
        font-weight: bold;
    }

  </style>
</head>
<body>

  <div class="loader" id="loader">
    <div class="spinner"></div>
    <h3>PDF tayyorlanmoqda...</h3>
  </div>

  <div class="container" id="appContainer">
    <div style="text-align:center; margin-bottom:30px;">
      <h1 style="color:var(--primary);">ğŸ“š Hadis Ilmi - Mustaqil Ish</h1>
    </div>

    <input type="text" id="studentName" placeholder="F.I.O va Guruhingizni yozing (Masalan: Aliyev Vali, 304-guruh)" />

    <div id="selectionSection">
      <div id="topicsContainer"></div>
      <div class="action-bar">
        <button class="btn" onclick="toggleSelectAll()">Hammasi</button>
        <button class="btn" id="nextBtn" onclick="goToEditor()" disabled>Davom etish</button>
      </div>
    </div>

    <div id="editorSection" style="display:none;">
      <div id="editorContainer"></div>
      
      <div class="editable-box">
        <h4>Xulosa:</h4>
        <div id="finalConclusion" contenteditable="true">
          Ushbu mavzularni o'rganib, men hadis ilmining nozik jihatlarini tushundim...
        </div>
      </div>

      <div class="action-bar">
        <button class="btn" style="background:#777" onclick="backToSelection()">Ortga</button>
        <button class="btn" onclick="generatePDF()">PDF YUKLAB OLISH</button>
      </div>
    </div>
  </div>

  <div id="pdfWrapper" style="position: absolute; top: 0; left: 0; width: 100%; z-index: -1;">
     <div id="pdfOutput"></div>
  </div>

  <script>
    // DATA
    const topics = [
  {
    id: 1,
    title: "Xabarlarning boâ€˜linishi (Hanafiylar va Muhaddislar)",
    content: `
      <h3>1-BOB: Xabarlarning mutavotir, mashhur va ahodga boâ€˜linishi</h3>

      <h4>1) Hanafiylarning taqsimoti (ittisol â€” Rasululloh ï·º ga bogâ€˜lanish jihatidan)</h4>
      <ul>
        <li><b>Mutavotir</b> â€” <u>surat jihatidan ham, maâ€™no jihatidan ham</u> mutlaqo shubhasiz; bogâ€˜lanish (ittisol) toâ€˜liq.</li>
        <li><b>Mashhur</b> â€” <u>surat jihatidan</u> shubha bor (1-asrda ahod boâ€˜lgan), lekin <u>maâ€™no jihatidan</u> shubha yoâ€˜q (2â€“3-asrlarda mutavotir boâ€˜lib, ummat qabul qilgan).</li>
        <li><b>Xabarul-vohid (Ahod)</b> â€” <u>surat jihatidan ham</u> shubha bor (1-asrda ahod), <u>maâ€™no jihatidan ham</u> shubha bor (mutavotir boâ€˜lmagan va 2â€“3-asrlarda ummat tomonidan qabul qilinmagan).</li>
      </ul>

      <div class="pdf-highlight">
        Xulosa: hanafiylar nazarida xabarlar 3 qism: <b>mutavotir</b>, <b>mashhur</b>, <b>ahod</b>.
      </div>

      <h4>2) Muhaddislarning taqsimoti</h4>
      <ul>
        <li>Koâ€˜pchilik muhaddislarga koâ€˜ra xabarlar 2 qism: <b>Mutavotir</b> va <b>Xabarul-vohid</b>.</li>
        <li>Keyin <b>xabarul-vohid</b> 3 qismga boâ€˜linadi: <b>mashhur</b>, <b>aziz</b>, <b>gâ€˜arib</b>.</li>
      </ul>

      <p><b>Eslatma:</b> Toâ€˜liq bogâ€˜lanishning yana bir turi bor â€” gapiruvchidan bevosita ogâ€˜zaki eshitish.
      Bu mutavotirdan ham kuchliroq (eshitish + koâ€˜rish tushunishga yaqinroq).</p>
    `
  },

  {
    id: 2,
    title: "Mutavotir xabar (taâ€™rif, shartlar, hukm, turlari)",
    content: `
      <h3>2-BOB: Mutavotir xabar</h3>

      <h4>1) Mutavotir xabarning taâ€™rifi</h4>

      <p><b>Lugâ€˜atda:</b> â€œTavoturâ€ â€” narsalarning ketma-ket kelishi boâ€˜lib, ular orasida boâ€˜shliq va vaqt oraligâ€˜i boâ€˜lishidir.
      Agar uzluksiz (boâ€˜shliqsiz) boâ€˜lsa, bu â€œmutavotirâ€ emas, oddiy ketma-ketlik boâ€˜ladi.</p>

      <p><b>Istilohda (Ibn as-Saâ€™atiy):</b> <b>â€œOâ€˜z-oâ€˜zidan ilmni hosil qiladigan jamoa xabari.â€</b></p>

      <p><b>â€œIlmni oâ€˜z-oâ€˜zidanâ€</b> deb cheklanishi sababi:
      tashqi qoâ€˜shimcha dalil bilan rostligi bilinadigan xabarlar bu taâ€™rifdan chiqadi (masalan, aql daliliga mos kelgan jamoa xabari).</p>

      <h4>2) Mutavotir xabarning shartlari (Hanafiy muhaqqiqlar nazarida)</h4>
      <ol>
        <li>
          <b>Koâ€˜plik sharti:</b> xabar beruvchilar shunchalik koâ€˜p boâ€˜lsinki,
          odatda aql ularning ataylab yolgâ€˜on ustida kelishib olishini yoki bilmasdan yolgâ€˜onga mos tushib qolishini imkonsiz deb bilsin.
        </li>
        <li>
          <b>Tabaqalarda davomiylik:</b> bu koâ€˜plik isnodning barcha tabaqalarida boâ€˜lishi kerak.
          <br><i>Eslatma:</i> tabaqalar son jihatidan â€œbir xilâ€ boâ€˜lishi shart emas â€” har tabaqa eshituvchiga ilm bersa yetadi.
          <br><b>Muqim qoida:</b> hanafiylar nazarida mutavotirlik <b>uch asr</b> (sahoba, tobiâ€˜in, tobiâ€˜ut-tobiâ€˜in) bilan bogâ€˜liq;
          undan keyingi davrlar mutavotirlikda eâ€™tiborga olinmaydi.
        </li>
        <li>
          <b>Sezgiga (his) asoslanish:</b> xabar mazmuni hissiy boâ€˜lishi kerak; aqliy masala boâ€˜lmasligi lozim.
        </li>
      </ol>

      <h4>3) â€œSezgiga asoslanishâ€ degani nima?</h4>
      <p>Mutavotir aqliy masalalarda boâ€˜lmaydi.
      Masalan, â€œdunyo yaratilgandirâ€ mazmuni aqliy â€” mazmun jihatidan mutavotir boâ€˜lmaydi.
      Lekin â€œBagâ€˜dod ahli shuni aytdiâ€ degan narsa â€” hissiy; bu jihatdan mutavotir boâ€˜lishi mumkin.</p>

      <h4>Muhim savol</h4>
      <p>Rasululloh ï·º dan mutavotir boâ€˜lib kelgan â€œKim â€˜La ilaha illallohâ€™ desa jannatga kiradiâ€ kabi hadislar zaruriy ilm beradimi?</p>
      <p><b>Javob:</b> bu yerda 2 masala bor:
      <br>â€” bu soâ€˜zning Rasululloh ï·º ga nisbat berilishi â€” hissiy (zaruriy ilm).
      <br>â€” mazmuni (jannatga kirishi) â€” aqliy (istidloliy ilm).</p>

      <h4>4) Mutavotir xabarning hukmi</h4>
      <div class="pdf-highlight">
        Koâ€˜pchilik ulamolar orasida ixtilof yoâ€˜q: <b>mutavotir xabar zaruriy ilm beradi</b>.
        <br>Uni inkor qilgan kishi <b>kofir</b> boâ€˜ladi.
      </div>

      <p>QozÄ± Iso ibn Aban: bu ilm majburiy-zaruriy; kim rad etsa Rasululloh ï·º ni rad etgandek boâ€˜ladi â€” shuning uchun Islomdan chiqadi.</p>

      <h4>5) Mutavotirda aniq son shartmi?</h4>
      <p><b>Hanafiylar:</b> aniq son shart emas.
      Mezon â€” <b>ilm va ishonch hosil boâ€˜lishi</b>. Qachon ilm hosil boâ€˜lsa, xabar mutavotir hisoblanadi.</p>

      <h4>6) Mutavotirning turlari</h4>
      <p>Muhaddislar: <b>lafziy</b> va <b>maâ€™naviy</b> deya boâ€˜lishgan.</p>
      <p>Imom Kashmiri taqsimoti (kengroq):</p>
      <ul>
        <li><b>Isnod mutavotiri</b></li>
        <li><b>Tabaqa mutavotiri</b></li>
        <li><b>Amal va meros mutavotiri</b></li>
        <li><b>Umumiy qadr mutavotiri</b></li>
      </ul>
    `
  },

  {
    id: 3,
    title: "Mashhur xabar (taâ€™rif, istiloh farqi, hukmi)",
    content: `
      <h3>3-BOB: Mashhur xabar</h3>

      <h4>1) Mashhur xabarning taâ€™rifi</h4>
      <p><b>Lugâ€˜atda:</b> â€œMashhurâ€ â€” ravshan, ochiq-oydin, keng tarqalgan.</p>

      <p><b>Hanafiy istilohida:</b>
      Mashhur xabar â€” <b>1-asrda ahod</b> boâ€˜lgan, keyin <b>2â€“3-asrlarda</b> (tobiâ€˜inlar va tobiâ€˜ut-tobiâ€˜inlar davrida)
      <b>mutavotir</b> boâ€˜lib ketgan xabardir. Shundan keyin uni yolgâ€˜on ustida kelishib olishlari tasavvur qilinmaydigan jamoa rivoyat qiladi.</p>

      <div class="pdf-highlight">
        Muhim shart: hanafiylar nazarida <b>uch asrdan keyin</b> yuzaga kelgan mashhurlik/mutavotirlik eâ€™tiborga olinmaydi.
      </div>

      <h4>2) Muhaddislar istilohida â€œmashhurâ€</h4>
      <p>Muhaddislar nazarida mashhur â€” <b>2 kishidan ortiq yoâ€˜l</b> bilan rivoyat qilinadigan,
      lekin <b>mutavotir darajasiga yetmagan</b> xabardir.</p>

      <h4>3) Mashhur xabarning hukmi</h4>
      <p>Hanafiylarning koâ€˜pchilik qarashi: mashhur xabar <b>yaqin ehtimolli gumon</b> beradi.
      Hanafiylar buni <b>â€œá¹­umaâ€™nina (xotirjamlik)â€</b> deb atashadi:
      qalb asosan xotirjam boâ€˜ladi, faqat 1-asrda ahod boâ€˜lganini eslaganda ozgina ikkilanish qoladi.</p>

      <p><b>Dalil:</b> 2â€“3-asrda mutavotir boâ€˜lsa ham, 1-asrda roviylar soni kam boâ€˜lgani sababli xato ehtimoli toâ€˜liq yoâ€˜qolmagan.</p>

      <div class="pdf-highlight">
        Shu sabab: koâ€˜pchilik hanafiylar nazarida mashhur xabarni inkor qilgan kishi <b>kofir emas</b>,
        balki <b>adashgan (zall)</b> hisoblanadi.
      </div>
    `
  },

  {
    id: 4,
    title: "Ahod xabarlar (Xabarul-vohid) â€” taâ€™rif va hukm",
    content: `
      <h3>4-BOB: Ahod xabarlar (Xabarul-vohid)</h3>

      <h4>1) Xabarul-vohidning taâ€™rifi</h4>

      <p><b>Lugâ€˜atda:</b> faqat bitta kishi rivoyat qilgan xabar.</p>

      <p><b>Istilohda (Hanafiylar):</b> mashhurlik va mutavotir darajasiga yetmagan <b>har qanday xabar</b>.
      Uni 1 kishi, 2â€“3 kishi yoki undan koâ€˜p kishi rivoyat qilsa ham â€” agar mashhur/mutavotir boâ€˜lmasa â€” istilohda baribir <b>xabarul-vohid</b> boâ€˜ladi.</p>

      <p><b>Natija:</b> istilohdagi â€œvohidâ€ doim lugâ€˜aviy â€œvohidâ€ bilan mos kelavermaydi:
      2â€“3 kishining rivoyati lugâ€˜atda â€œvohidâ€ emas, lekin mashhur boâ€˜lmagani uchun istilohda â€œxabarul-vohidâ€ sanaladi.</p>

      <p><b>Muhaddislar istilohida:</b> mutavotir shartlari yoâ€˜q xabar. Ular uni 3 qism deydi: mashhur, aziz, gâ€˜arib.</p>

      <h4>2) Xabarul-vohidning hukmi</h4>
      <div class="pdf-highlight">
        Hanafiylar ittifoqiga koâ€˜ra: xabarul-vohid (shartlari boâ€˜lsa) <b>ilm bermaydi</b>,
        lekin <b>amal qilishni vojib qiladigan kuchli gumon</b> beradi.
      </div>
    `
  },

  // Qolganlari PART 2 da toâ€˜liq qilib beriladi (Zabt, Adolat, Bidâ€™atchi, Mastur/majhul va h.k.)
  {
  id: 5,
  title: "Roviy shartlari: Aql",
  content: `
    <h3>5-BOB: Roviyda aql sharti</h3>

    <h4>1) Aql shartining maâ€™nosi</h4>
    <p>Roviy <b>aql egasi</b> boâ€˜lishi shart. Aql yoâ€˜q boâ€˜lsa, xabarni tushunish, yodlash va yetkazish mumkin boâ€˜lmaydi.</p>

    <h4>2) Aqlga zid holatlar</h4>
    <ul>
      <li><b>Majnun (aqli yoâ€˜q)</b> â€” rivoyati mutlaqo qabul qilinmaydi.</li>
      <li><b>Hushsiz / telbalik holati</b> â€” shu paytdagi rivoyati olinmaydi.</li>
      <li><b>Bola</b> â€” balogâ€˜atga yetmagan boâ€˜lsa, rivoyati qabul qilinmaydi.</li>
    </ul>

    <div class="pdf-highlight">
      Xulosa: Aql â€” roviylikning asosiy poydevori. Aqlsiz roviy = ishonchsiz xabar.
    </div>
  `
},

{
  id: 6,
  title: "Roviy shartlari: Islom",
  content: `
    <h3>6-BOB: Roviyda Islom sharti</h3>

    <h4>1) Islom shartining sababi</h4>
    <p>Hadis â€” <b>shariat dalili</b>. Uni yetkazuvchi shariatni hurmat qiluvchi boâ€˜lishi kerak.</p>

    <h4>2) Kofirning rivoyati</h4>
    <ul>
      <li><b>Kofir holida rivoyat qilsa</b> â€” qabul qilinmaydi.</li>
      <li><b>Kofir boâ€˜lib eshitib, keyin musulmon boâ€˜lib rivoyat qilsa</b> â€” qabul qilinadi (koâ€˜pchilik ulamolar nazarida).</li>
    </ul>

    <p>Sababi: rivoyat paytida u Islomga sodiq boâ€˜lgan boâ€˜ladi.</p>

    <div class="pdf-highlight">
      Mezon â€” <b>rivoyat qilish vaqtidagi holat</b>, eshitish vaqtidagi emas.
    </div>
  `
},

{
  id: 7,
  title: "Zabt (yodlash va aniqlik)",
  content: `
    <h3>7-BOB: Zabt (Roviyning aniqligi)</h3>

    <h4>1) Zabtning taâ€™rifi</h4>
    <p><b>Zabt</b> â€” roviy eshitgan narsasini <b>aniq yodlab</b>, keyinchalik <b>oâ€˜zgartirmasdan yetkazish qobiliyati</b>.</p>

    <h4>2) Zabtning ikki turi</h4>
    <ul>
      <li>
        <b>Zabt as-sadr</b> â€” yoddan mustahkam saqlash.
        <br><i>(xotirasi kuchli roviy)</i>
      </li>
      <li>
        <b>Zabt al-kitab</b> â€” yozma manbani buzmasdan saqlash.
        <br><i>(kitobiga suyanadigan roviy)</i>
      </li>
    </ul>

    <h4>3) Zabtning buzilishi nimada bilinadi?</h4>
    <ul>
      <li>Koâ€˜p xato qilish</li>
      <li>Roviylarning ishonchli rivoyatlariga zid kelish</li>
      <li>Bir hadisni turli joyda qarama-qarshi qilib aytish</li>
    </ul>

    <div class="pdf-highlight">
      Zabt yoâ€˜q boâ€˜lsa â€” roviy ishonchli emas, hatto taqvodor boâ€˜lsa ham.
    </div>
  `
},

{
  id: 8,
  title: "Adolat (axloqiy ishonchlilik)",
  content: `
    <h3>8-BOB: Adolat</h3>

    <h4>1) Adolatning taâ€™rifi</h4>
    <p><b>Adolat</b> â€” roviy <b>katta gunohlardan yiroq</b>, <b>kichik gunohlarda odatlanmagan</b>,
    hamda <b>muruwwat</b> (insoniy shaâ€™n) ni saqlagan boâ€˜lishidir.</p>

    <h4>2) Adolatga zid holatlar</h4>
    <ul>
      <li>Katta gunoh qilish</li>
      <li>Kichik gunohda doimiylik</li>
      <li>Muruwwatni buzadigan ishlar (odamlar nazarida pastlik)</li>
    </ul>

    <h4>3) Muruwwat nima?</h4>
    <p>Jamiyatda odob va shaâ€™n hisoblangan narsalarni saqlash.
    Masalan: ochiq-oydin past ishlar, behayo harakatlar â€” muruwwatga zid.</p>

    <h4>4) Adolat va zabt farqi</h4>
    <ul>
      <li><b>Adolat</b> â€” axloqiy ishonchlilik</li>
      <li><b>Zabt</b> â€” ilmiy aniqlik</li>
    </ul>

    <div class="pdf-highlight">
      Roviy uchun <b>ikkalasi ham shart</b>: adolat bor, zabt yoâ€˜q â†’ rivoyat olinmaydi.
    </div>
  `
},
 {
  id: 9,
  title: "Bidâ€™atchi roviyning rivoyati",
  content: `
    <h3>9-BOB: Bidâ€™atchi roviyning rivoyati</h3>

    <h4>1) Bidâ€™at nima?</h4>
    <p>Bidâ€™at â€” Qurâ€™on va sunnatda boâ€˜lmagan eâ€™tiqod yoki amalni din nomidan kiritish.</p>

    <h4>2) Bidâ€™atchilar turlari</h4>
    <ul>
      <li><b>Kufrga olib boruvchi bidâ€™at</b> â€” masalan, sahobalarni kofirga chiqarish.</li>
      <li><b>Kufrga olib bormaydigan bidâ€™at</b> â€” masalan, baâ€™zi aqidaviy xatolar.</li>
    </ul>

    <h4>3) Hanafiylar qarashi</h4>
    <ul>
      <li>Agar bidâ€™ati <b>kufrga olib borsa</b> â€” rivoyati <b>mutlaqo qabul qilinmaydi</b>.</li>
      <li>Agar bidâ€™ati <b>kufrga olib bormasa</b>:
        <ul>
          <li>Yolgâ€˜onchi boâ€˜lmasa</li>
          <li>Bidâ€™atini targâ€˜ib qilmasa</li>
          <li>Rivoyati bidâ€™atini kuchaytirmasa</li>
        </ul>
        â†’ <b>rivoyati qabul qilinadi</b>.
      </li>
    </ul>

    <h4>4) Muhaddislar qarashi</h4>
    <p>Koâ€˜pchilik muhaddislar ham xuddi shu mezonlarga amal qiladi,
    lekin baâ€™zilari bidâ€™atchidan ehtiyot chorasi sifatida rivoyat olmaydi.</p>

    <div class="pdf-highlight">
      Mezon: yolgâ€˜on + bidâ€™atni yoyish xavfi boâ€˜lmasa â€” rivoyat olinishi mumkin.
    </div>
  `
},

{
  id: 10,
  title: "Mastur va Majhul roviylar",
  content: `
    <h3>10-BOB: Mastur va Majhul roviy</h3>

    <h4>1) Majhul roviy</h4>
    <p><b>Majhul</b> â€” roviy haqida yetarli maâ€™lumot yoâ€˜q.</p>

    <ul>
      <li><b>Majhul al-â€˜ayn</b> â€” faqat bitta kishi rivoyat qilgan, boshqalar tanimaydi.</li>
      <li><b>Majhul al-hal</b> â€” shaxsi maâ€™lum, lekin adolat/zabt nomaâ€™lum.</li>
    </ul>

    <h4>2) Mastur roviy</h4>
    <p><b>Mastur</b> â€” tashqi koâ€˜rinishda solih, lekin ichki holati (adolat darajasi) tekshirilmagan.</p>

    <h4>3) Hanafiylar qarashi</h4>
    <ul>
      <li>Mastur roviy â€” <b>qabul qilinadi</b>, agar ochiq fasodi boâ€˜lmasa.</li>
      <li>Sababi: asl hol â€” musulmonda adolat bor deb hisoblanadi.</li>
    </ul>

    <h4>4) Muhaddislar qarashi</h4>
    <ul>
      <li>Majhul va mastur roviy â€” <b>zaif</b>.</li>
      <li>Sababi: roviy tekshirilmaguncha ishonch hosil boâ€˜lmaydi.</li>
    </ul>

    <div class="pdf-highlight">
      Bu yerda hanafiylar va muhaddislar yoâ€˜li keskin farqlanadi.
    </div>
  `
},

{
  id: 11,
  title: "Hanafiylar va Muhaddislar oâ€˜rtasidagi asosiy farqlar",
  content: `
    <h3>11-BOB: Asosiy metodologik farqlar</h3>

    <table class="comparison-table">
      <tr>
        <th>Masala</th>
        <th>Hanafiylar</th>
        <th>Muhaddislar</th>
      </tr>
      <tr>
        <td>Mashhur xabar</td>
        <td>Ahod â†’ keyin mutavotir</td>
        <td>2+ yoâ€˜l bilan kelgan xabar</td>
      </tr>
      <tr>
        <td>Mastur roviy</td>
        <td>Qabul qilinadi</td>
        <td>Zaif</td>
      </tr>
      <tr>
        <td>Xabarul-vohid</td>
        <td>Ilm bermaydi, amal vojib</td>
        <td>Sahih boâ€˜lsa amal qilinadi</td>
      </tr>
      <tr>
        <td>Mutavotir mezoni</td>
        <td>Ilm hosil boâ€˜lishi</td>
        <td>Koâ€˜plik + shartlar</td>
      </tr>
    </table>
  `
},

{
  id: 12,
  title: "Yakuniy xulosa va imtihon uchun qisqa algoritm",
  content: `
    <h3>12-BOB: Yakuniy xulosa</h3>

    <h4>1) Hadisni baholash algoritmi</h4>
    <ol>
      <li>Xabar turi: mutavotir / mashhur / ahod</li>
      <li>Roviyda aql va Islom bormi?</li>
      <li>Adolat bormi?</li>
      <li>Zabt bormi?</li>
      <li>Bidâ€™at yoki yolgâ€˜on alomatlari yoâ€˜qmi?</li>
    </ol>

    <h4>2) Qisqa eslab qolish formulasi</h4>
    <div class="pdf-highlight">
      Mutavotir â†’ ilm + kufr hukmi<br>
      Mashhur â†’ tumaâ€™nina + adashish<br>
      Ahod â†’ amal vojib, ilm yoâ€˜q
    </div>

    <h4>3) Talaba uchun maslahat</h4>
    <p>Hanafiy usulini tushunmasdan hadis ilmidagi ixtiloflarni tushunib boâ€˜lmaydi.
    Bu farqlar â€œqarama-qarshilikâ€ emas, balki <b>metod farqi</b>.</p>
  `
}

];

    let selected = [];
    let edits = {};

    // 1. DASTURNI YURGIZISH
    window.addEventListener('DOMContentLoaded', () => {
      const cont = document.getElementById('topicsContainer');
      cont.innerHTML = topics.map(t => `
        <div class="card" id="card-${t.id}" onclick="toggle(${t.id})">
          <div class="card-header">
            <div class="check-icon" id="check-${t.id}"><i class="fa fa-check"></i></div>
            <span>${t.id}. ${t.title}</span>
          </div>
        </div>
      `).join('');
    });

    // 2. LOGIKA
    function toggle(id) {
      if(selected.includes(id)) selected = selected.filter(x => x !== id);
      else selected.push(id);
      
      // UI yangilash
      topics.forEach(t => {
         const el = document.getElementById(`card-${t.id}`);
         const ic = document.getElementById(`check-${t.id}`);
         if(selected.includes(t.id)) {
           el.classList.add('selected');
           ic.style.background = '#4e54c8';
           ic.style.borderColor = '#4e54c8';
         } else {
           el.classList.remove('selected');
           ic.style.background = 'transparent';
           ic.style.borderColor = '#ccc';
         }
      });
      document.getElementById('nextBtn').disabled = selected.length === 0;
    }

    function toggleSelectAll() {
      if(selected.length === topics.length) selected = [];
      else selected = topics.map(t => t.id);
      
      // UI Update (oddiyroq yo'l bilan)
      topics.forEach(t => {
         // Force update visuals
         const el = document.getElementById(`card-${t.id}`);
         const ic = document.getElementById(`check-${t.id}`);
         if(selected.includes(t.id)) {
           el.classList.add('selected');
           ic.style.background = '#4e54c8';
         } else {
           el.classList.remove('selected');
           ic.style.background = 'transparent';
         }
      });
      document.getElementById('nextBtn').disabled = selected.length === 0;
    }

    function goToEditor() {
      const name = document.getElementById('studentName').value;
      if(!name) return alert("Ismingizni kiriting!");

      document.getElementById('selectionSection').style.display = 'none';
      document.getElementById('editorSection').style.display = 'block';

      const cont = document.getElementById('editorContainer');
      cont.innerHTML = '';
      
      selected.sort((a,b)=>a-b).forEach(id => {
        const t = topics.find(x => x.id === id);
        const div = document.createElement('div');
        div.className = 'editable-box';
        div.innerHTML = `
          <h4 style="color:#888; margin-bottom:10px">${t.title}</h4>
          <div id="edit-${id}" contenteditable="true" style="outline:none">${edits[id] || t.content}</div>
        `;
        cont.appendChild(div);
      });
    }

    function backToSelection() {
      document.getElementById('selectionSection').style.display = 'block';
      document.getElementById('editorSection').style.display = 'none';
    }

    // --- PDF GENERATSIYA (TUZATILGAN) ---
    function generatePDF() {
      // 1. Ma'lumotlarni saqlash
      selected.forEach(id => {
        const el = document.getElementById(`edit-${id}`);
        if(el) edits[id] = el.innerHTML;
      });
      const conclusion = document.getElementById('finalConclusion').innerHTML;
      const name = document.getElementById('studentName').value;

      // 2. PDF shablonini to'ldirish
      const output = document.getElementById('pdfOutput');
      output.innerHTML = `
        <div class="pdf-header">
          <h1>MUSTAQIL ISH</h1>
          <h3>Mavzu: Hadis ilmi (Mustalahul hadis)</h3>
          <p style="margin-top:15px"><strong>Bajardi:</strong> ${name}</p>
          <p><strong>Sana:</strong> ${new Date().toLocaleDateString()}</p>
        </div>
      `;

      selected.forEach(id => {
        const t = topics.find(x => x.id === id);
        output.innerHTML += `
          <div class="pdf-topic">
            <div class="pdf-title">${t.id}. ${t.title}</div>
            <div class="pdf-text">${edits[id] || t.content}</div>
          </div>
        `;
      });

      output.innerHTML += `
        <div style="margin-top:40px; border-top:2px solid #000; padding-top:20px;">
          <h3>XULOSA</h3>
          <div class="pdf-text">${conclusion}</div>
        </div>
      `;

      // 3. GENERATSIYA JARAYONI
      const loader = document.getElementById('loader');
      loader.classList.add('active');

      // SIR SHU YERDA: Elementni ko'rinadigan qilamiz, lekin ustidan loader yopib turadi
      output.style.display = 'block';
      
      const opt = {
        margin:       15,
        filename:     `${name.replace(/\s/g, '_')}_Mustaqil_Ish.pdf`,
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2, useCORS: true },
        jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };

      // Brauzer render qilishi uchun ozgina vaqt beramiz
      setTimeout(() => {
        html2pdf().set(opt).from(output).save().then(() => {
          loader.classList.remove('active');
          output.style.display = 'none'; // Qaytarib yashiramiz
          alert("PDF Muvaffaqiyatli yuklandi!");
        }).catch(err => {
          loader.classList.remove('active');
          output.style.display = 'none';
          alert("Xatolik: " + err.message);
        });
      }, 500);
    }
  </script>
</body>
</html>
